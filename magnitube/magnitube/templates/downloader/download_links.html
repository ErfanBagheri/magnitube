{% extends "downloader/index.html" %}
{% load dict_extras %}

{% block results %}
<fieldset class="results">
	<legend>Download Links</legend>
	<ul>
	{% for fmt, link in links %}
	<li>
		{% autoescape off %}
		<!-- YouTube Link: {{link}} -->
		{% endautoescape %}
		<a href="/{{video_id}}/{{fmt}}/view/"><img src="{{STATIC_URL}}images/control.png" title="Play" /></a>
		<a href="/{{video_id}}/{{fmt}}/"><img src="{{STATIC_URL}}images/download.png" title="Download" /> 
		{{formats|get_item:fmt|get_item:'resolution'}} ({{formats|get_item:fmt|get_item:'ext'}})</a></li>
	{% empty %}
	<li>Nothing Available :(</li>
	{% endfor %}
	</ul>
</fieldset>
<fieldset class="results">
	<legend>Preview</legend>
	<div class="preview">
		<video src="http://magnitu.be/{{video_id}}/{% if 18 in current_fmts %}18{% elif 43 in current_fmts %}43{% elif 5 in current_fmts %}5{% elif 6 in current_fmts %}6{% else %}{{current_fmts|get_item:0}}/{{filename}}?view=1">
		</video>		
	</div>
	<script type="text/javascript">
		$('video,audio').mediaelementplayer({videoWidth: 396});
	</script>
</fieldset>
{% endblock %}

{% block extrahead %}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="{{STATIC_URL}}mediaelement/mediaelement-and-player.js"></script>
<link rel="stylesheet" href="{{STATIC_URL}}mediaelement/mediaelementplayer.css" />
{% endblock %}